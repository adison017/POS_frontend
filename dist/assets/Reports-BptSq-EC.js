const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dataService-DioIbMCu.js","assets/apiClient-CgrKIHeM.js"])))=>i.map(i=>d[i]);
import{r as d,j as e,y as M,_ as nt}from"./index-C7VodmU4.js";import{getMenuItems as ot,getExpenses as lt,getIncome as dt,getOrderItems as ct,createIncome as it,createExpense as xt}from"./dataService-DioIbMCu.js";import"./apiClient-CgrKIHeM.js";const ft=()=>{const[I,te]=d.useState("dashboard"),[n,O]=d.useState({start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[L,Ie]=d.useState("today"),[W,le]=d.useState({start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[H,Le]=d.useState([]),[se,We]=d.useState([]),[He,Pe]=d.useState([]),[f,de]=d.useState([]),[w,ce]=d.useState([]),[Ee,ie]=d.useState(!1),[V,xe]=d.useState(""),[me,$]=d.useState(1),[z,ue]=d.useState({x:0,y:0}),[Fe,ae]=d.useState(!1),[he,Be]=d.useState({x:0,y:0}),[j,ge]=d.useState("day"),[Y,pe]=d.useState(new Date().toISOString().split("T")[0]),[q,ye]=d.useState(()=>{const t=new Date,s=t.getFullYear(),a=new Date(s,0,1),r=Math.floor((t-a)/864e5)+a.getDay(),o=Math.ceil((r+1)/7);return`${s}-W${String(o).padStart(2,"0")}`}),[G,be]=d.useState(()=>new Date().toISOString().slice(0,7)),[U,fe]=d.useState(new Date().getFullYear());d.useEffect(()=>{const t=s=>new Date(s.getTime()-s.getTimezoneOffset()*6e4).toISOString().split("T")[0];if(j==="day"){const s=new Date(Y);O({start:t(s),end:t(s)})}else if(j==="week"){const[s,a]=q.split("-W"),r=parseInt(s,10),o=parseInt(a,10),h=new Date(r,0,4),y=h.getDay()||7,i=new Date(h);i.setDate(h.getDate()-(y-1)+(o-1)*7);const x=new Date(i);x.setDate(i.getDate()+6),O({start:t(i),end:t(x)})}else if(j==="month"){const[s,a]=G.split("-").map(h=>parseInt(h,10)),r=new Date(s,a-1,1),o=new Date(s,a,0);O({start:t(r),end:t(o)})}else if(j==="year"){const s=parseInt(String(U),10),a=new Date(s,0,1),r=new Date(s,11,31);O({start:t(a),end:t(r)})}},[j,Y,q,G,U]);const[Ve,J]=d.useState(!1),[Re,X]=d.useState(!1),[D,P]=d.useState({category:"",amount:"",note:""}),[S,E]=d.useState({category:"",amount:"",note:""});d.useEffect(()=>{(async()=>{try{const[s,a,r,o]=await Promise.all([(await nt(async()=>{const{getOrdersPage:y}=await import("./dataService-DioIbMCu.js");return{getOrdersPage:y}},__vite__mapDeps([0,1]))).getOrdersPage({limit:50,offset:0}),ot(),lt(),dt()]);Le(s),Pe(a),de(r),ce(o);const h=await Promise.all(s.map(y=>ct(y.id)));We(h.flat()),M.success("โหลดข้อมูลรายงานเรียบร้อยแล้ว")}catch(s){console.error("Error loading report data:",s),M.error("ไม่สามารถโหลดข้อมูลรายงานได้")}})()},[]);const p=t=>`฿${t.toFixed(2)}`,je=()=>{$(1),ue({x:0,y:0})},Te=()=>$(t=>Math.min(5,+(t+.2).toFixed(2))),$e=()=>$(t=>Math.max(.5,+(t-.2).toFixed(2))),we=t=>{if(!t)return!1;try{const a=new URL(t,window.location.href).pathname.toLowerCase();return a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")}catch{const a=String(t).toLowerCase();return a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")}},ve=t=>({pm_cash:"เงินสด",pm_credit:"บัตรเครดิต",pm_debit:"บัตรเดบิต",pm_qr:"QR Payment",cash:"เงินสด",transfer:"โอนเงิน",promptpay:"พร้อมเพย์"})[t]||t||"ไม่ระบุ",Ne=t=>{switch(t){case"pm_cash":case"cash":return e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})});case"pm_credit":case"pm_debit":case"transfer":return e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})});case"pm_qr":case"promptpay":return e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})});default:return e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}},ze=async t=>{if(t.preventDefault(),D.category&&D.amount)try{const s={id:`inc_${Date.now()}`,category:D.category,amount:parseFloat(D.amount),note:D.note||"",created_at:new Date().toISOString(),income_date:new Date().toISOString().split("T")[0]},a=await it(s);a.error?M.error("ไม่สามารถเพิ่มรายรับได้"):(ce([a.data,...w]),P({category:"",amount:"",note:""}),J(!1),M.success("เพิ่มรายรับเรียบร้อยแล้ว"))}catch(s){console.error("Error adding income:",s),M.error("เกิดข้อผิดพลาดในการเพิ่มรายรับ")}},Ye=async t=>{if(t.preventDefault(),S.category&&S.amount)try{const s={id:`exp_${Date.now()}`,category:S.category,amount:parseFloat(S.amount),note:S.note||"",created_at:new Date().toISOString(),expense_date:new Date().toISOString().split("T")[0]},a=await xt(s);a.error?M.error("ไม่สามารถเพิ่มรายจ่ายได้"):(de([a.data,...f]),E({category:"",amount:"",note:""}),X(!1),M.success("เพิ่มรายจ่ายเรียบร้อยแล้ว"))}catch(s){console.error("Error adding expense:",s),M.error("เกิดข้อผิดพลาดในการเพิ่มรายจ่าย")}},v=(()=>{try{const t=Array.isArray(H)?H.filter(Boolean):[],s=Array.isArray(f)?f.filter(Boolean):[],a=Array.isArray(w)?w.filter(Boolean):[],r=Array.isArray(se)?se.filter(Boolean):[],o=new Date().toDateString(),h=new Date(Date.now()-864e5).toDateString(),y=t.filter(l=>l.status==="paid"&&new Date(l.created_at).toDateString()===o),i=t.filter(l=>l.status==="paid"&&new Date(l.created_at).toDateString()===h),x=y.reduce((l,u)=>l+(Number(u.grand_total)||0),0),m=i.reduce((l,u)=>l+(Number(u.grand_total)||0),0),N=y.length,B=i.length,R=N>0?x/N:0,ee=B>0?m/B:0,T=s.filter(l=>{const u=new Date(l.created_at),C=new Date(n.start),g=new Date(n.end);return g.setHours(23,59,59,999),u>=C&&u<=g}),Oe=a.filter(l=>{const u=new Date(l.created_at),C=new Date(n.start),g=new Date(n.end);return g.setHours(23,59,59,999),u>=C&&u<=g}),Ke=T.reduce((l,u)=>l+(Number(u.amount)||0),0),et=Oe.reduce((l,u)=>l+(Number(u.amount)||0),0),Ae=x-Ke+et,tt=x>0?Ae/x*100:0,st=(()=>{try{const l=new Map;let u=[];if(L==="today")u=t.filter(g=>g.status==="paid"&&new Date(g.created_at).toDateString()===o);else if(L==="thisWeek"){const g=new Date;g.setDate(g.getDate()-7),u=t.filter(k=>{const b=new Date(k.created_at);return k.status==="paid"&&b>=g})}else if(L==="thisMonth"){const g=new Date,k=new Date(g.getFullYear(),g.getMonth(),1);u=t.filter(b=>{const A=new Date(b.created_at);return b.status==="paid"&&A>=k})}else if(L==="custom"){const g=new Date(W.start),k=new Date(W.end);k.setHours(23,59,59,999),u=t.filter(b=>{const A=new Date(b.created_at);return b.status==="paid"&&A>=g&&A<=k})}return u.forEach(g=>{r.filter(b=>b.order_id===g.id).forEach(b=>{if(l.has(b.item_id)){const A=l.get(b.item_id);A.qty+=Number(b.qty)||0,A.revenue+=Number(b.total_price)||0}else l.set(b.item_id,{id:b.item_id,name:b.name||"ไม่ระบุ",qty:Number(b.qty)||0,revenue:Number(b.total_price)||0})})}),Array.from(l.values()).sort((g,k)=>k.qty-g.qty||k.revenue-g.revenue).slice(0,5)}catch(l){return console.error("Error calculating menu sales stats:",l),[]}})(),at=y.reduce((l,u)=>{const C=u.payment_method||"ไม่ระบุ";return l[C]||(l[C]={count:0,amount:0}),l[C].count+=1,l[C].amount+=Number(u.grand_total)||0,l},{}),rt=Object.entries(at).map(([l,u])=>({method:l,count:u.count,amount:u.amount}));return{todaySales:x,yesterdaySales:m,todayOrders:N,yesterdayOrders:B,avgOrderValue:R,yesterdayAvgOrderValue:ee,netProfit:Ae,profitMargin:tt,topMenus:st,paymentMethods:rt,filteredExpenses:T,filteredIncome:Oe}}catch(t){return console.error("Error calculating dashboard data:",t),{todaySales:0,yesterdaySales:0,todayOrders:0,yesterdayOrders:0,avgOrderValue:0,yesterdayAvgOrderValue:0,netProfit:0,profitMargin:0,topMenus:[],paymentMethods:[],todayExpenses:[],todayIncome:[]}}})(),c={todaySales:v?.todaySales||0,yesterdaySales:v?.yesterdaySales||0,todayOrders:v?.todayOrders||0,yesterdayOrders:v?.yesterdayOrders||0,avgOrderValue:v?.avgOrderValue||0,yesterdayAvgOrderValue:v?.yesterdayAvgOrderValue||0,netProfit:v?.netProfit||0,profitMargin:v?.profitMargin||0,topMenus:Array.isArray(v?.topMenus)?v.topMenus:[],paymentMethods:Array.isArray(v?.paymentMethods)?v.paymentMethods:[],filteredExpenses:Array.isArray(v?.filteredExpenses)?v.filteredExpenses:[],filteredIncome:Array.isArray(v?.filteredIncome)?v.filteredIncome:[]},Z=t=>{const s=new Date;let a;if(t==="day")a=new Date(s.getFullYear(),s.getMonth(),s.getDate());else if(t==="week"){const i=new Date(s),x=i.getDay(),m=x===0?6:x-1;i.setHours(0,0,0,0),i.setDate(i.getDate()-m),a=i}else t==="month"?a=new Date(s.getFullYear(),s.getMonth(),1):t==="year"?a=new Date(s.getFullYear(),0,1):a=new Date(0);const r=new Date(s.getFullYear(),s.getMonth(),s.getDate(),23,59,59,999),o=(H||[]).filter(i=>{if(i?.status!=="paid")return!1;const x=new Date(i.created_at);return x>=a&&x<=r}),h=o.reduce((i,x)=>i+Number(x.grand_total||0),0),y=o.length;return{total:h,count:y}};Z("day"),Z("week"),Z("month"),Z("year");const[_,qe]=d.useState("day"),[De,Ge]=d.useState(new Date().toISOString().split("T")[0]),[Se,Ue]=d.useState(()=>{const t=new Date,s=t.getFullYear(),a=new Date(s,0,1),r=Math.floor((t-a)/864e5)+a.getDay(),o=Math.ceil((r+1)/7);return`${s}-W${String(o).padStart(2,"0")}`}),[ke,Je]=d.useState(()=>new Date().toISOString().slice(0,7)),[Me,Xe]=d.useState(new Date().getFullYear()),[F,_e]=d.useState({start:new Date().toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),Ze=()=>{const t=s=>new Date(s.getFullYear(),s.getMonth(),s.getDate());if(_==="day"){const s=new Date(De),a=t(s),r=new Date(a);return r.setHours(23,59,59,999),{start:a,end:r}}else if(_==="week"){const[s,a]=Se.split("-W"),r=parseInt(s,10),o=parseInt(a,10),h=new Date(r,0,4),y=h.getDay()||7,i=new Date(h);i.setDate(h.getDate()-(y-1)+(o-1)*7);const x=new Date(i);return x.setDate(i.getDate()+6),x.setHours(23,59,59,999),{start:t(i),end:x}}else if(_==="month"){const[s,a]=ke.split("-").map(h=>parseInt(h,10)),r=new Date(s,a-1,1),o=new Date(s,a,0);return o.setHours(23,59,59,999),{start:r,end:o}}else if(_==="year"){const s=parseInt(String(Me),10),a=new Date(s,0,1),r=new Date(s,11,31,23,59,59,999);return{start:a,end:r}}else{const s=new Date(F.start),a=new Date(F.end);return a.setHours(23,59,59,999),{start:s,end:a}}},Q=(()=>{const{start:t,end:s}=Ze(),a=(H||[]).filter(m=>m?.status==="paid"&&new Date(m.created_at)>=t&&new Date(m.created_at)<=s),r=a.reduce((m,N)=>m+Number(N.grand_total||0),0),o=a.length,h=o>0?r/o:0,y=(f||[]).filter(m=>new Date(m.created_at)>=t&&new Date(m.created_at)<=s).reduce((m,N)=>m+Number(N.amount||0),0),i=(w||[]).filter(m=>new Date(m.created_at)>=t&&new Date(m.created_at)<=s).reduce((m,N)=>m+Number(N.amount||0),0),x=r-y+i;return{periodSales:r,periodOrderCount:o,periodAvg:h,periodNetProfit:x}})(),K={periodSales:Q?.periodSales||0,periodOrderCount:Q?.periodOrderCount||0,periodAvg:Q?.periodAvg||0,periodNetProfit:Q?.periodNetProfit||0},Ce=(()=>{const t=[],s=new Date;for(let r=6;r>=0;r--){const o=new Date(s);o.setDate(s.getDate()-r);const h=o.toISOString().slice(0,10);t.push({key:h,label:o.toLocaleDateString("th-TH",{day:"2-digit",month:"short"}),total:0})}const a=Object.fromEntries(t.map(r=>[r.key,r]));return(H||[]).forEach(r=>{if(r?.status!=="paid")return;const o=new Date(r.created_at).toISOString().slice(0,10);a[o]&&(a[o].total+=Number(r.grand_total||0))}),t})(),Qe=({data:t,height:s=180,barColor:a="#2563EB"})=>{const y=s-56-16,i=Math.max(1,...t.map(N=>N.total)),x=8,m=Math.max(10,(504-x*(t.length-1))/t.length);return e.jsxs("svg",{viewBox:`0 0 560 ${s}`,className:"w-full h-auto",children:[e.jsx("rect",{x:"0",y:"0",width:560,height:s,fill:"#ffffff",rx:"12"}),e.jsx("line",{x1:28,y1:28+y,x2:532,y2:28+y,stroke:"#E5E7EB"}),t.map((N,B)=>{const R=28+B*(m+x),ee=N.total/i*y,T=28+(y-ee);return e.jsxs("g",{children:[e.jsx("rect",{x:R,y:T,width:m,height:ee,rx:"6",fill:a,opacity:"0.85"}),e.jsx("text",{x:R+m/2,y:T-6,textAnchor:"middle",fontSize:"11",fill:"#111827",fontWeight:"700",children:`฿${N.total.toFixed(0)}`}),e.jsx("text",{x:R+m/2,y:28+y+14,textAnchor:"middle",fontSize:"10",fill:"#6B7280",children:N.label})]},B)})]})},re=c.yesterdaySales>0?(c.todaySales-c.yesterdaySales)/c.yesterdaySales*100:0,ne=c.yesterdayOrders>0?(c.todayOrders-c.yesterdayOrders)/c.yesterdayOrders*100:0,oe=c.yesterdayAvgOrderValue>0?(c.avgOrderValue-c.yesterdayAvgOrderValue)/c.yesterdayAvgOrderValue*100:0;return e.jsx("div",{id:"reportSection",className:"p-4 md:p-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4 md:p-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"รายงานยอดขาย"})}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6 overflow-x-auto pb-2",children:[e.jsx("button",{onClick:()=>{te("dashboard"),M.info("กำลังโหลดข้อมูลแดชบอร์ด...")},className:`report-tab px-4 py-2.5 rounded-lg text-sm font-bold transition-all duration-200 whitespace-nowrap ${I==="dashboard"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"แดชบอร์ด"}),e.jsx("button",{onClick:()=>{te("sales"),M.info("กำลังโหลดรายงานขาย...")},className:`report-tab px-4 py-2.5 rounded-lg text-sm font-bold transition-all duration-200 whitespace-nowrap ${I==="sales"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"รายงานขาย"}),e.jsx("button",{onClick:()=>{te("finance"),M.info("กำลังโหลดข้อมูลรายรับ-รายจ่าย...")},className:`report-tab px-4 py-2.5 rounded-lg text-sm font-bold transition-all duration-200 whitespace-nowrap ${I==="finance"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"รายรับ-รายจ่าย"})]}),I==="dashboard"&&e.jsxs("div",{className:"report-content flex-1 overflow-y-auto",children:[e.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs("select",{value:_,onChange:t=>qe(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"day",children:"วัน"}),e.jsx("option",{value:"week",children:"สัปดาห์"}),e.jsx("option",{value:"month",children:"เดือน"}),e.jsx("option",{value:"year",children:"ปี"}),e.jsx("option",{value:"custom",children:"กำหนดเอง"})]}),_==="day"&&e.jsx("input",{type:"date",value:De,onChange:t=>Ge(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),_==="week"&&e.jsx("input",{type:"week",value:Se,onChange:t=>Ue(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),_==="month"&&e.jsx("input",{type:"month",value:ke,onChange:t=>Je(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),_==="year"&&e.jsx("input",{type:"number",min:"2000",max:"2100",value:Me,onChange:t=>Xe(t.target.value),className:"w-28 px-3 py-2 border border-gray-300 rounded-lg"}),_==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:F.start,onChange:t=>_e({...F,start:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("span",{className:"flex items-center text-gray-500",children:"ถึง"}),e.jsx("input",{type:"date",value:F.end,onChange:t=>_e({...F,end:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-5 shadow-sm",children:[e.jsx("p",{className:"text-sm text-blue-700 font-medium mb-1",children:"ยอดขายรวม (ช่วงที่เลือก)"}),e.jsx("h3",{className:"text-2xl font-bold text-blue-900",children:p(K.periodSales)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-emerald-100 border border-emerald-200 rounded-xl p-5 shadow-sm",children:[e.jsx("p",{className:"text-sm text-emerald-700 font-medium mb-1",children:"จำนวนออเดอร์"}),e.jsx("h3",{className:"text-2xl font-bold text-emerald-900",children:K.periodOrderCount})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 border border-amber-200 rounded-xl p-5 shadow-sm",children:[e.jsx("p",{className:"text-sm text-amber-700 font-medium mb-1",children:"ค่าเฉลี่ยต่อออเดอร์"}),e.jsx("h3",{className:"text-2xl font-bold text-amber-900",children:p(K.periodAvg)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-fuchsia-50 to-fuchsia-100 border border-fuchsia-200 rounded-xl p-5 shadow-sm",children:[e.jsx("p",{className:"text-sm text-fuchsia-700 font-medium mb-1",children:"กำไรสุทธิ"}),e.jsx("h3",{className:"text-2xl font-bold text-fuchsia-900",children:p(K.periodNetProfit)})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-bold text-gray-800",children:"แนวโน้มยอดขาย 7 วัน"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["รวม: ",p(Ce.reduce((t,s)=>t+s.total,0))]})]}),e.jsx(Qe,{data:Ce})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-600 font-medium mb-1",children:"ยอดขายวันนี้"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:p(c.todaySales)})]}),e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),e.jsxs("div",{className:`flex items-center mt-3 text-sm ${re>=0?"text-green-600":"text-red-600"}`,children:[e.jsx("svg",{className:`w-4 h-4 mr-1 ${re>=0?"rotate-0":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})}),Math.abs(re).toFixed(1),"% จากเมื่อวาน"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border border-green-100 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 font-medium mb-1",children:"ออเดอร์วันนี้"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:c.todayOrders})]}),e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})})]}),e.jsxs("div",{className:`flex items-center mt-3 text-sm ${ne>=0?"text-green-600":"text-red-600"}`,children:[e.jsx("svg",{className:`w-4 h-4 mr-1 ${ne>=0?"rotate-0":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})}),Math.abs(ne).toFixed(1),"% จากเมื่อวาน"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 border border-amber-100 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-600 font-medium mb-1",children:"เฉลี่ยต่อออเดอร์"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:p(c.avgOrderValue)})]}),e.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]}),e.jsxs("div",{className:`flex items-center mt-3 text-sm ${oe>=0?"text-green-600":"text-red-600"}`,children:[e.jsx("svg",{className:`w-4 h-4 mr-1 ${oe>=0?"rotate-0":"rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})}),Math.abs(oe).toFixed(1),"% จากเมื่อวาน"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-100 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-purple-600 font-medium mb-1",children:"กำไรสุทธิ"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:p(c.netProfit)})]}),e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 11l3-3m0 0l3 3m-3-3v8m0-13a9 9 0 110 18 9 9 0 010-18z"})})})]}),e.jsxs("div",{className:"flex items-center mt-3 text-sm text-gray-600",children:["Margin: ",c.profitMargin.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4",children:[e.jsx("h4",{className:"font-bold text-gray-800",children:"เมนูขายดีอันดับต้น ๆ"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("select",{value:L,onChange:t=>Ie(t.target.value),className:"px-2 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"today",children:"วันนี้"}),e.jsx("option",{value:"thisWeek",children:"สัปดาห์นี้"}),e.jsx("option",{value:"thisMonth",children:"เดือนนี้"}),e.jsx("option",{value:"custom",children:"กำหนดเอง"})]}),L==="custom"&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{type:"date",value:W.start,onChange:t=>le({...W,start:t.target.value}),className:"px-2 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{className:"flex items-center text-gray-500 text-sm",children:"ถึง"}),e.jsx("input",{type:"date",value:W.end,onChange:t=>le({...W,end:t.target.value}),className:"px-2 py-1 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),e.jsx("div",{className:"space-y-4",children:c.topMenus.length>0?c.topMenus.map((t,s)=>{const a=He.find(r=>r.id===t.id);return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-6 h-6 flex items-center justify-center bg-gray-100 text-gray-700 text-xs font-bold rounded-full mr-3",children:s+1}),a?.image_url?e.jsx("img",{src:a.image_url,alt:a.name,className:"w-8 h-8 object-cover rounded-lg mr-2"}):e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg mr-2 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("span",{className:"font-medium text-gray-800",children:t.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-gray-800",children:p(t.revenue)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.qty," รายการ"]})]})]},t.id)}):e.jsx("div",{className:"text-center py-4 text-gray-500",children:"ยังไม่มีข้อมูลเมนูขายดี"})})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm",children:[e.jsx("h4",{className:"font-bold text-gray-800 mb-4",children:"วิธีการชำระเงิน"}),e.jsx("div",{className:"space-y-4",children:c.paymentMethods.length>0?c.paymentMethods.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-3 text-gray-500",children:Ne(t.method)}),e.jsx("span",{className:"font-medium text-gray-800",children:ve(t.method)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-gray-800",children:p(t.amount)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.count," รายการ"]})]})]},s)):e.jsx("div",{className:"text-center py-4 text-gray-500",children:"ยังไม่มีข้อมูลการชำระเงิน"})})]})]})]}),I==="sales"&&e.jsxs("div",{className:"report-content flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"รายงานยอดขาย"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs("select",{value:j,onChange:t=>ge(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"day",children:"เลือกวัน"}),e.jsx("option",{value:"week",children:"เลือกสัปดาห์"}),e.jsx("option",{value:"month",children:"เลือกเดือน"}),e.jsx("option",{value:"year",children:"เลือกปี"}),e.jsx("option",{value:"custom",children:"กำหนดเอง"})]}),j==="day"&&e.jsx("input",{type:"date",value:Y,onChange:t=>pe(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),j==="week"&&e.jsx("input",{type:"week",value:q,onChange:t=>ye(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),j==="month"&&e.jsx("input",{type:"month",value:G,onChange:t=>be(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),j==="year"&&e.jsx("input",{type:"number",min:"2000",max:"2100",value:U,onChange:t=>fe(t.target.value),className:"w-28 px-3 py-2 border border-gray-300 rounded-lg"}),j==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:n.start,onChange:t=>O({...n,start:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("span",{className:"flex items-center text-gray-500",children:"ถึง"}),e.jsx("input",{type:"date",value:n.end,onChange:t=>O({...n,end:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ออเดอร์ #"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วันที่"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"รายการ"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วิธีชำระเงิน"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ยอดรวม"}),e.jsx("th",{className:"py-3 px-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"สลิป"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:H.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).map(t=>{const s=se.filter(a=>a.order_id===t.id);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"py-3 px-4 text-sm font-medium text-gray-900",children:["#",t.order_no]}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-500",children:e.jsxs("div",{className:"flex flex-col",children:[s.slice(0,2).map(a=>e.jsxs("span",{children:[a.name," x",a.qty]},a.id)),s.length>2&&e.jsxs("span",{className:"text-xs text-gray-400",children:["+",s.length-2," รายการอื่น"]})]})}),e.jsx("td",{className:"py-3 px-4 text-sm",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-gray-500",children:Ne(t.payment_method)}),e.jsx("span",{className:"font-medium",children:ve(t.payment_method)})]})}),e.jsx("td",{className:"py-3 px-4 text-sm font-bold text-gray-900",children:p(t.grand_total)}),e.jsx("td",{className:"py-3 px-4 text-sm",children:t.receipt_url?e.jsxs("button",{type:"button",onClick:()=>{xe(t.receipt_url),ie(!0)},className:"inline-flex items-center text-indigo-600 hover:text-indigo-800",children:["ดูสลิป",e.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 10l4.553-4.553a1 1 0 00-1.414-1.414L13.5 8.672M19 10h-4a1 1 0 00-1 1v8a1 1 0 001 1h4a1 1 0 001-1v-8a1 1 0 00-1-1z"})})]}):e.jsx("span",{className:"text-gray-400",children:"-"})})]},t.id)})})]})})]}),I==="finance"&&e.jsxs("div",{className:"report-content flex-1 overflow-y-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"งบกำไรขาดทุน"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>J(!0),className:"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-4 py-2.5 rounded-lg font-bold transition-all duration-200 shadow hover:shadow-md flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"เพิ่มรายรับ"]}),e.jsxs("button",{onClick:()=>X(!0),className:"bg-gradient-to-r from-red-500 to-rose-600 hover:from-red-600 hover:to-rose-700 text-white px-4 py-2.5 rounded-lg font-bold transition-all duration-200 shadow hover:shadow-md flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"เพิ่มรายจ่าย"]})]})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6",children:[e.jsx("h4",{className:"text-md font-bold text-gray-800",children:"กรองข้อมูลตามช่วงเวลา"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs("select",{value:j,onChange:t=>ge(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[e.jsx("option",{value:"day",children:"เลือกวัน"}),e.jsx("option",{value:"week",children:"เลือกสัปดาห์"}),e.jsx("option",{value:"month",children:"เลือกเดือน"}),e.jsx("option",{value:"year",children:"เลือกปี"}),e.jsx("option",{value:"custom",children:"กำหนดเอง"})]}),j==="day"&&e.jsx("input",{type:"date",value:Y,onChange:t=>pe(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),j==="week"&&e.jsx("input",{type:"week",value:q,onChange:t=>ye(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),j==="month"&&e.jsx("input",{type:"month",value:G,onChange:t=>be(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg"}),j==="year"&&e.jsx("input",{type:"number",min:"2000",max:"2100",value:U,onChange:t=>fe(t.target.value),className:"w-28 px-3 py-2 border border-gray-300 rounded-lg"}),j==="custom"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",value:n.start,onChange:t=>O({...n,start:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg"}),e.jsx("span",{className:"flex items-center text-gray-500",children:"ถึง"}),e.jsx("input",{type:"date",value:n.end,onChange:t=>O({...n,end:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-lg"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-5 rounded-xl border border-gray-200",children:[e.jsx("h4",{className:"font-bold text-gray-800 mb-4",children:"งบกำไรขาดทุน (ช่วงเวลาที่เลือก)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-700",children:"รายรับจากการขาย"}),e.jsx("span",{className:"font-medium text-gray-800",children:p(c.todaySales)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-700",children:"รายรับอื่นๆ"}),e.jsx("span",{className:"font-medium text-gray-800",children:p(Array.isArray(w)?w.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).reduce((t,s)=>t+(Number(s.amount)||0),0):0)})]}),e.jsxs("div",{className:"flex justify-between font-bold py-2 border-b border-gray-300",children:[e.jsx("span",{className:"text-gray-800",children:"รายรับรวม"}),e.jsx("span",{className:"text-green-600",children:p(c.todaySales+(Array.isArray(w)?w.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).reduce((t,s)=>t+(Number(s.amount)||0),0):0))})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200 mt-3",children:[e.jsx("span",{className:"text-gray-700",children:"ต้นทุนขาย (COGS)"}),e.jsx("span",{className:"font-medium text-gray-800",children:p(0)})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-700",children:"ค่าใช้จ่ายดำเนินงาน"}),e.jsx("span",{className:"font-medium text-gray-800",children:p(Array.isArray(f)?f.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).reduce((t,s)=>t+(Number(s.amount)||0),0):0)})]}),e.jsxs("div",{className:"flex justify-between font-bold py-2 border-b border-gray-300",children:[e.jsx("span",{className:"text-gray-800",children:"ค่าใช้จ่ายรวม"}),e.jsx("span",{className:"text-red-600",children:p(Array.isArray(f)?f.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).reduce((t,s)=>t+(Number(s.amount)||0),0):0)})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg py-3 border-t border-gray-400 mt-2",children:[e.jsx("span",{className:"text-gray-900",children:"กำไรสุทธิ"}),e.jsx("span",{className:"text-blue-600",children:p(c.netProfit)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800 mb-4",children:"สถิติการเงิน"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-4 rounded-xl border border-green-100 text-center",children:[e.jsx("p",{className:"text-xs text-green-700 mb-1",children:"Gross Margin"}),e.jsxs("p",{className:"text-xl font-bold text-green-900",children:[c.todaySales>0?((c.todaySales-(Array.isArray(f)?f.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).reduce((t,s)=>t+(Number(s.amount)||0),0):0))/c.todaySales*100).toFixed(1):"0","%"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-100 text-center",children:[e.jsx("p",{className:"text-xs text-blue-700 mb-1",children:"Net Margin"}),e.jsxs("p",{className:"text-xl font-bold text-blue-900",children:[c.todaySales>0?(c.netProfit/c.todaySales*100).toFixed(1):"0","%"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-amber-50 p-4 rounded-xl border border-yellow-100 text-center",children:[e.jsx("p",{className:"text-xs text-yellow-700 mb-1",children:"รายรับเฉลี่ย/วัน"}),e.jsx("p",{className:"text-xl font-bold text-yellow-900",children:p(Array.isArray(w)&&w.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).length>0?w.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).reduce((t,s)=>t+(Number(s.amount)||0),0)/w.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).length:0)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-fuchsia-50 p-4 rounded-xl border border-purple-100 text-center",children:[e.jsx("p",{className:"text-xs text-purple-700 mb-1",children:"ค่าใช้จ่ายเฉลี่ย/วัน"}),e.jsx("p",{className:"text-xl font-bold text-purple-900",children:p(Array.isArray(f)&&f.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).length>0?f.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).reduce((t,s)=>t+(Number(s.amount)||0),0)/f.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).length:0)})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200",children:[e.jsx("h4",{className:"font-bold text-gray-800 mb-4",children:"รายรับอื่นๆ (ช่วงเวลาที่เลือก)"}),e.jsxs("div",{className:"space-y-3",children:[Array.isArray(w)?w.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:t.category}),e.jsx("p",{className:"text-sm text-gray-600 truncate max-w-[150px]",children:t.note})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"font-bold text-gray-800",children:p(t.amount)})})]},s)):[],Array.isArray(w)&&w.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).length===0&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:e.jsx("svg",{className:"w-10 h-10 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("p",{className:"text-gray-500",children:"ยังไม่มีข้อมูลรายรับ"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-200",children:[e.jsx("h4",{className:"font-bold text-gray-800 mb-4",children:"รายจ่าย (ช่วงเวลาที่เลือก)"}),e.jsxs("div",{className:"space-y-3",children:[Array.isArray(f)?f.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:t.category}),e.jsx("p",{className:"text-sm text-gray-600 truncate max-w-[150px]",children:t.note})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"font-bold text-gray-800",children:p(t.amount)})})]},s)):[],Array.isArray(f)&&f.filter(t=>{const s=new Date(t.created_at),a=new Date(n.start),r=new Date(n.end);return r.setHours(23,59,59,999),s>=a&&s<=r}).length===0&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:e.jsx("svg",{className:"w-10 h-10 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("p",{className:"text-gray-500",children:"ยังไม่มีข้อมูลรายจ่าย"})]})]})]})]})]}),Ve&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"เพิ่มรายรับ"}),e.jsx("button",{onClick:()=>{J(!1),P({category:"",amount:"",note:""})},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:ze,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"หมวดหมู่"}),e.jsx("input",{type:"text",value:D.category,onChange:t=>P({...D,category:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"เช่น ขายของ, บริการ, อื่นๆ",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"จำนวนเงิน"}),e.jsx("input",{type:"number",step:"0.01",value:D.amount,onChange:t=>P({...D,amount:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"หมายเหตุ"}),e.jsx("textarea",{value:D.note,onChange:t=>P({...D,note:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"เพิ่มรายละเอียดเพิ่มเติม (ถ้ามี)",rows:"3"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{J(!1),P({category:"",amount:"",note:""})},className:"flex-1 py-3 px-4 bg-gray-100 text-gray-700 rounded-lg font-bold hover:bg-gray-200 transition-colors duration-200",children:"ยกเลิก"}),e.jsx("button",{type:"submit",className:"flex-1 py-3 px-4 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-bold hover:from-green-600 hover:to-emerald-700 transition-all duration-200 shadow hover:shadow-md",children:"บันทึก"})]})]})]})}),Re&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"เพิ่มรายจ่าย"}),e.jsx("button",{onClick:()=>{X(!1),E({category:"",amount:"",note:""})},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:Ye,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"หมวดหมู่"}),e.jsx("input",{type:"text",value:S.category,onChange:t=>E({...S,category:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"เช่น วัตถุดิบ, ค่าแรง, ค่าเช่า, อื่นๆ",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"จำนวนเงิน"}),e.jsx("input",{type:"number",step:"0.01",value:S.amount,onChange:t=>E({...S,amount:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"หมายเหตุ"}),e.jsx("textarea",{value:S.note,onChange:t=>E({...S,note:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"เพิ่มรายละเอียดเพิ่มเติม (ถ้ามี)",rows:"3"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{X(!1),E({category:"",amount:"",note:""})},className:"flex-1 py-3 px-4 bg-gray-100 text-gray-700 rounded-lg font-bold hover:bg-gray-200 transition-colors duration-200",children:"ยกเลิก"}),e.jsx("button",{type:"submit",className:"flex-1 py-3 px-4 bg-gradient-to-r from-red-500 to-rose-600 text-white rounded-lg font-bold hover:from-red-600 hover:to-rose-700 transition-all duration-200 shadow hover:shadow-md",children:"บันทึก"})]})]})]})}),Ee&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"สลิปการชำระเงิน"}),e.jsx("button",{onClick:()=>{ie(!1),xe("")},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 bg-gray-50",children:we(V)?e.jsx("div",{className:"w-full h-full overflow-hidden flex items-center justify-center",onWheel:t=>{t.preventDefault();const s=t.deltaY>0?-.1:.1;$(a=>Math.max(.5,Math.min(5,+(a+s).toFixed(2))))},onMouseDown:t=>{ae(!0),Be({x:t.clientX-z.x,y:t.clientY-z.y})},onMouseMove:t=>{Fe&&ue({x:t.clientX-he.x,y:t.clientY-he.y})},onMouseUp:()=>ae(!1),onMouseLeave:()=>ae(!1),onDoubleClick:je,role:"presentation",children:e.jsx("div",{className:"p-4",style:{transform:`translate(${z.x}px, ${z.y}px) scale(${me})`,transformOrigin:"center center"},children:e.jsx("img",{src:V,alt:"Receipt",className:"max-w-none max-h-none object-contain rounded-lg shadow select-none pointer-events-none"})})}):e.jsx("iframe",{title:"receipt-preview",src:V,className:"w-full h-[80vh] bg-white"})}),e.jsxs("div",{className:"p-3 border-t border-gray-200 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:e.jsx("span",{children:"เลื่อนเมาส์เพื่อซูม, ลากเพื่อเลื่อน, ดับเบิลคลิกเพื่อรีเซ็ต"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[we(V)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:$e,className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700",children:"−"}),e.jsxs("span",{className:"w-12 text-center text-sm text-gray-700",children:[Math.round(me*100),"%"]}),e.jsx("button",{onClick:Te,className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700",children:"+"}),e.jsx("button",{onClick:je,className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700",children:"รีเซ็ต"})]}),e.jsx("a",{href:V,target:"_blank",rel:"noreferrer",className:"px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700",children:"เปิดแท็บใหม่"})]})]})]})})]})})};export{ft as default};
